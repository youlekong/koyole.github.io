<!DOCTYPE html>
<html>
  <head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="google-site-verification" content="v24WJQb0ZRnWSW9oNk49JVDx9SXCmZj3nOSAHggz1hM" />
  <meta name="description" content="javascript | HTML5 | CSS3 | PHP | React | Vue">
  <meta name="keywords" content="javascript, HTML5, CSS3, PHP, React, Vue">
  <meta name="baidu-site-verification" content="sccUG6vhhH" />

  <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <title>YOLE</title>
  <style>
    html, body {
        color: #000;
        font-family: "Times New Roman", Times, serif;
    }
  </style>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlight.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
  <body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header class="header">
  <div class="blog-title">
    <a href="/" class="logo">YOLE</a>
    <span class="subtitle">424188487@qq.com</span>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">Home</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">Archives</a>
        </li>
      
        <li class="menu-item">
          <a href="https://github.com/youlekong" class="menu-item-link">Github</a>
        </li>
      
    </ul>
  </nav>
</header>
    <main class="main">
      <article class="post">
  <div class="post-title">
    <h2 class="title">初始化React项目</h2>
  </div>
  <div class="post-meta">
    <span class="post-time">2017-11-25</span>
  </div>
  <div class="post-content">
    <p>react + react-router + react-rudux + webpack</p>
<a id="more"></a>
<p>基本环境</p>
<ul>
<li>nodejs(npm)</li>
</ul>
<h3 id="一-初始化目录"><a href="#一-初始化目录" class="headerlink" title="一.初始化目录"></a>一.初始化目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$mkdir</span> react-webpack</div><div class="line"><span class="variable">$cd</span> react-webpack</div><div class="line"><span class="variable">$npm</span> init   <span class="comment">#生成package.json文件</span></div></pre></td></tr></table></figure>
<h3 id="二-安装依赖包"><a href="#二-安装依赖包" class="headerlink" title="二.安装依赖包"></a>二.安装依赖包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># react，react-dom是React核心包</span></div><div class="line"><span class="variable">$npm</span> i --save-dev react react-dom react-transform-hmr redbox-react react-transform-catch-errors</div><div class="line"><span class="comment"># 使用webpack做前端模块化工具</span></div><div class="line"><span class="variable">$npm</span> i --save-dev webpack webpack-dev-server </div><div class="line"><span class="comment"># babel转换es6语法</span></div><div class="line"><span class="variable">$npm</span> i --save-dev babel-core babel-loader babel-preset-react babel-preset-es2015 babel-plugin-react-transform </div><div class="line"><span class="comment"># 使用sass预编译css</span></div><div class="line"><span class="variable">$npm</span> i --save-dev css-loader style-loader sass-loader node-sass</div><div class="line"><span class="comment"># 使用axios做ajax请求</span></div><div class="line"><span class="variable">$npm</span> i --save-dev axios</div><div class="line"><span class="comment"># react-redux及其middleware</span></div><div class="line"><span class="variable">$npm</span> i --save-dev react-redux redux redux-logger redux-thunk</div><div class="line"><span class="comment"># react-router</span></div><div class="line"><span class="variable">$npm</span> i --save-dev react-router-dom</div></pre></td></tr></table></figure>
<p>安装完成后package.json</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">"devDependencies": &#123;</div><div class="line">    "babel-core": "^6.26.0",</div><div class="line">    "babel-loader": "^7.1.2",</div><div class="line">    "babel-plugin-react-transform": "^3.0.0",</div><div class="line">    "babel-preset-es2015": "^6.24.1",</div><div class="line">    "babel-preset-react": "^6.24.1",</div><div class="line">    "css-loader": "^0.28.7",</div><div class="line">    "node-sass": "^4.6.1",</div><div class="line">    "react": "^16.1.1",</div><div class="line">    "react-dom": "^16.1.1",</div><div class="line">    "react-transform-catch-errors": "^1.0.2",</div><div class="line">    "react-transform-hmr": "^1.0.4",</div><div class="line">    "redbox-react": "^1.5.0",</div><div class="line">    "sass-loader": "^6.0.6",</div><div class="line">    "style-loader": "^0.19.0",</div><div class="line">    "url-loader": "^0.6.2",</div><div class="line">    "webpack": "^3.8.1",</div><div class="line">    "webpack-dev-server": "^2.9.4",</div><div class="line">    "axios": "^0.17.1",</div><div class="line">    "react-redux": "^5.0.6",</div><div class="line">    "react-router-dom": "^4.2.2",</div><div class="line">    "redux": "^3.7.2",</div><div class="line">    "redux-logger": "^3.0.6",</div><div class="line">    "redux-thunk": "^2.2.0"</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p><em>ps</em>：<strong>npm install axios@0.17.1</strong> 通过添加版本好安装指定版本</p>
<h3 id="三-webpack配置"><a href="#三-webpack配置" class="headerlink" title="三.webpack配置"></a>三.webpack配置</h3><p>react+webpack配置与vue+webpack下的大同小异<br>根据不同版本查看官方文档配置需求，<a href="https://doc.webpack-china.org/" target="_blank" rel="external">webpack中文文档</a></p>
<h4 id="0-基本配置"><a href="#0-基本配置" class="headerlink" title="0.基本配置"></a>0.基本配置</h4><p>核心模块：entry，output，module，plugin</p>
<ul>
<li>entry：构建spa或mpa应用时都需要一个或多个入口文件，以便webpack构建内部依赖</li>
<li>output：构建完成后webpack的输出配置</li>
<li>module：webpack自身只理解js文件。在构建过程中遇到不同的资源如图片，css等，需要通过不通的loader转换</li>
<li>plugin：对资源的处理，如压缩文件，提取css文件</li>
</ul>
<p>文件webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    entry: path.resolve(__dirname, <span class="string">'./src/app.jsx'</span>),   <span class="comment">// 指定入口</span></div><div class="line">    output: &#123;</div><div class="line">        path: path.resolve(__dirname, <span class="string">'./build'</span>),       <span class="comment">// 指定出口</span></div><div class="line">        filename: <span class="string">'index.js'</span></div><div class="line">    &#125;,</div><div class="line">    <span class="built_in">module</span>: &#123;</div><div class="line">        loaders: [</div><div class="line">            &#123;</div><div class="line">                test: <span class="regexp">/\.(js|jsx)$/</span>,            <span class="comment">// jsx,js文件转换es6为es5loader</span></div><div class="line">                exclude: <span class="regexp">/node_modules/</span>,</div><div class="line">                loader: <span class="string">'babel-loader'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                test: <span class="regexp">/\.(less|css|scss)$/</span>,     <span class="comment">// 行内css，scss文件loader</span></div><div class="line">                loader: <span class="string">'style-loader!css-loader!sass-loader'</span></div><div class="line">            &#125;,</div><div class="line">            &#123;</div><div class="line">                test: <span class="regexp">/\.(png|jpg|jpeg)$/</span>,      <span class="comment">// 图片</span></div><div class="line">                use: &#123;</div><div class="line">                    loader: <span class="string">"url-loader"</span>,</div><div class="line">                    options: &#123;</div><div class="line">                        limit: <span class="number">8192</span></div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    plugins: [</div><div class="line">        <span class="comment">// TODO</span></div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="1-开发环境配置"><a href="#1-开发环境配置" class="headerlink" title="1.开发环境配置"></a>1.开发环境配置</h4><p>webpack-dev-server是小型的nodejs服务器，用于本地开发测试</p>
<ul>
<li>热加载：自动检测文件更改，加载</li>
<li>服务代理（proxy）：解决前后端分离时的跨域问题，本地服务器与前端同源，使用本地服务器代理实际后端</li>
<li>本地资源服务（contentBase）：方便资源引用</li>
</ul>
<p>文件webpack.config.dev.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">devServer: &#123;</div><div class="line">        contentBase: [<span class="string">"./build"</span>, <span class="string">"./assets/"</span>],  <span class="comment">// contentBase中接受一个数组，指定不同的资源目录</span></div><div class="line">        historyApiFallback: <span class="literal">true</span>,</div><div class="line">        inline: <span class="literal">true</span>,</div><div class="line">        noInfo: <span class="literal">true</span>,</div><div class="line">        disableHostCheck: <span class="literal">true</span>,</div><div class="line">        port: <span class="number">4444</span>,</div><div class="line">        proxy: &#123;                        </div><div class="line">          <span class="string">"/api"</span>: &#123;</div><div class="line">            target: <span class="string">'http://xxx.xxx.xxx'</span>,       <span class="comment">// 代理目标服务器</span></div><div class="line">            secure: <span class="literal">false</span>,      </div><div class="line">            changeOrigin: <span class="literal">true</span>,</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;,</div></pre></td></tr></table></figure>
<h4 id="2-添加钩子函数"><a href="#2-添加钩子函数" class="headerlink" title="2.添加钩子函数"></a>2.添加钩子函数</h4><p>在package.json文件下添加生产，本地环境</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">"scripts": &#123;</div><div class="line">    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",</div><div class="line">    "build": "webpack",</div><div class="line">    "dev": "webpack-dev-server --config webpack.config.dev.js"</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 本地环境</span></div><div class="line"><span class="variable">$npm</span> run dev</div><div class="line"><span class="comment"># 生产环境</span></div><div class="line"><span class="variable">$npm</span> run build</div></pre></td></tr></table></figure>
<h3 id="四-react相关"><a href="#四-react相关" class="headerlink" title="四.react相关"></a>四.react相关</h3><p><a href="http://www.css88.com/react/" target="_blank" rel="external">react中文文档</a><br><a href="http://reacttraining.cn/" target="_blank" rel="external">react-router中文文档</a><br><a href="http://cn.redux.js.org/" target="_blank" rel="external">react-redux中文文档</a></p>
<p><em>ps</em>：使用时需要注意版本，不同版本下的api可能不同</p>
<h4 id="1-react-router"><a href="#1-react-router" class="headerlink" title="1.react-router"></a>1.react-router</h4><p>react-router4的使用与其他版本的不同</p>
<p>文件route.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">import</span> &#123; </div><div class="line">    HashRouter <span class="keyword">as</span> Router, </div><div class="line">    Route, </div><div class="line">    Switch</div><div class="line">&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> Index <span class="keyword">from</span> <span class="string">'./view/index.jsx'</span></div><div class="line"><span class="keyword">import</span> Movie <span class="keyword">from</span> <span class="string">'./view/movie.jsx'</span></div><div class="line"><span class="keyword">import</span> MovieList <span class="keyword">from</span> <span class="string">'./view/movieList.jsx'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">const</span> route = <span class="function"><span class="params">()</span> =&gt;</span> (</div><div class="line">    &lt;Router&gt;</div><div class="line">      &lt;Switch&gt;</div><div class="line">        &lt;Route exact path=<span class="string">"/"</span> component=&#123;Index&#125;/&gt;</div><div class="line">        &lt;Route path=<span class="string">"/movie/:movieId"</span> component=&#123;Movie&#125;/&gt;</div><div class="line">        &lt;Route path=<span class="string">'/movieList'</span> component=&#123;MovieList&#125;&gt;&lt;/Route&gt;</div><div class="line">      &lt;<span class="regexp">/Switch&gt;</span></div><div class="line"><span class="regexp">    &lt;/</span>Router&gt;</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> route</div></pre></td></tr></table></figure>
<p>Ⅰ.路由方式</p>
<ul>
<li>react-router有BrowserRouter，HashRouter，MemoryRouter，StaticRouter路由组件，其中BrowserRouter，HashRouter在浏览器中使用，实现前端路由功能。</li>
<li>BrowserRouter基于url的location.pathname，HashRouter基于location.hash。</li>
<li>在使用BrowserRouter搭建应用时，需要服务器对前端路由路径的修改，以防止跳转后页面再刷新出现404错误。</li>
</ul>
<p>Ⅱ.嵌套路由</p>
<ul>
<li>react-router4路由与其他版本的不同，router下只能有一个根节点。</li>
</ul>
<p>Ⅲ.js跳转</p>
<ul>
<li>this.props.history对象实现页面路由跳转</li>
</ul>
<h4 id="2-react-redux"><a href="#2-react-redux" class="headerlink" title="2.react-redux"></a>2.react-redux</h4><p>Ⅰ. 单一状态</p>
<ul>
<li>redux是在应用比较复杂情况下，对整个应用的数据及状态变化集中管理，因此在一个spa应用中应该有且只有一个store。</li>
</ul>
<p>Ⅱ. 单向数据流</p>
<ul>
<li>为了便于追踪数据状态的流动过程，redux使用单向数据流管理数据。</li>
<li>对state的更新通过dispatch获取action对象，reducer对action的处理，state改变时通知component做re-render。</li>
<li>在createStore是可以添加中间件</li>
</ul>
<p>Ⅲ. react-redux</p>
<p>redux与React没有直接关系，需要通过react-redux结合react和redux。react-redux提供Provide与connect功能模块。</p>
<ul>
<li>Provider组件主要将属性(props)直接给子孙component，无须通过props层层传递，从而减少组件的依赖关系。</li>
<li>connect方法的主要作用就是让Component与Store进行关联， Store的数据变化可以及时通知Views重新渲染。</li>
</ul>
<p>文件store.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux'</span></div><div class="line"><span class="keyword">import</span> thunkMiddleware <span class="keyword">from</span> <span class="string">'redux-thunk'</span></div><div class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">'redux-logger'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducer.js'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//创建一个 Redux store 来以存放应用中所有的 state，应用中应有且仅有一个 store。</span></div><div class="line"><span class="keyword">var</span> store = createStore(</div><div class="line">    reducer,</div><div class="line">    applyMiddleware(       <span class="comment">// 应用中间件</span></div><div class="line">        thunkMiddleware, <span class="comment">// 允许我们 dispatch() 函数</span></div><div class="line">        logger</div><div class="line">    )</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</div></pre></td></tr></table></figure>
  </div>
</article>
    </main>
    <footer class='footer'>
	<span>© 2016-2018</span>
	<a href='https://hexo.io/zh-cn/'>hexo</a>
</footer>

<script src="/js/highlight.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112017168-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments)}
    gtag('js', new Date());
    gtag('config', 'UA-112017168-1');
</script>
<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?79947b6af0dc16bd0e5cab5df00cde71";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  </body>
</html>